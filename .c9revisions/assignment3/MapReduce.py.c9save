{"ts":1369272495234,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"import json\n\nclass MapReduce:\n    def __init__(self):\n        self.intermediate = {}\n        self.result = []\n\n    def emit_intermediate(self, key, value):\n        self.intermediate.setdefault(key, [])\n        self.intermediate[key].append(value)\n\n    def emit(self, value):\n        self.result.append(value) \n\n    def execute(self, data, mapper, reducer):\n        for line in data:\n            mapper(self, line)\n\n        for key in self.intermediate:\n            reducer(self, key, self.intermediate[key])\n\n        jenc = json.JSONEncoder(encoding='latin-1')\n        for item in self.result:\n            print jenc.encode(item)\n\ndef execute(data, mapper, reducer):\n    mr = MapReduce()\n    mr.execute(data, mapper, reducer)\n"]],"start1":0,"start2":0,"length1":0,"length2":726}]],"length":726}
